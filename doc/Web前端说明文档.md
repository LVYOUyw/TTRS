# WEB前端使用说明

## 面向普通用户

### 用户相关操作

+ 注册：点击网页右上角“注册”按钮即可注册。
+ 登陆：点击网页右上角“登陆”按钮即可登陆。
+ 查看、修改自己的用户信息：登陆后点击右上角带有用户ID的按钮。注：密码留空表示不修改密码，不留空表示修改密码
+ 退出：点击网页右上角“退出”按钮

### 车票相关操作

+ 查询车票
  1. 点击导航栏上的“查询”
  2. 再表单中输入出发地、目的地（有自动补全功能），选择日期、类型、是否查询中转
  3. 点击“查询”，等待结果显示在页面下方
+ 订票
  1. 按照上述方法先查询出有效的车票
  2. 点击想购买的票种右方的“订票”按钮
  3. 在弹出的窗口中输入购票数量
  4. 确认信息后点击“订票”按钮
+ 查询自己的购票记录
  1. 登陆后，点击右上角的“购票记录”
  2. 输入用户ID、日期和查询的类型
  3. 点击“查询”按钮
  4. 提醒：管理员可以查询其他用户的购票记录，普通用户只能查询自己的购票记录
+ 退票
  1. 按照上述方法查询到有效的购票记录
  2. 点击想要退的票种右边的“退票”按钮
  3. 在弹出的窗口中输入退票数量
  4. 确认信息后点击“退票”按钮
+ 查询车次信息
  1. 点击导航栏上的“查询车次”
  2. 输入车次之后点击”查询“

## 面向管理员

### 管理用户

 	1. 点击导航栏上的”管理“，点击下拉菜单中的”管理用户“
		2. 输入用户ID，点击”查询“，可以查询到用户的信息
		3. 修改信息的操作请查看面向普通用户的说明
		4. 勾选”管理员“后的复选框可以把普通用户提升为管理员。（该操作不可撤回）

### 添加车次

1. 点击导航栏上的”管理“，点击下拉菜单中的”添加车次“
2. 输入车次ID，车次名，选择车次类型
3. 选择车票类型
4. 按”+“可以添加车站信息，注意时间和价格的格式
5. 输入完一条车站信息后，请点击该行右侧”+“号，添加车站
6. 可以对车站记录进行修改和删除。
7. 信息输入完成后点击”提交“按钮

### 发售、修改、删除车次

1. 点击导航栏上的”管理“，点击下拉菜单中的”管理车次“
2. 找到想要操作的车次，点击右侧相应操作的按钮即可



# 开发文档

## 简介

软件名称：NAIVE订票系统

开发环境：windows10、ubuntu16.04、Debian 9

测试环境：windows10、ubuntu16.04、Debian 9

开发技术：HTML+CSS+Javascript+AJAX+Python2.7

使用框架：Flask 1.0.2（Werkzeug0.14.1 Jinja2.10) 、Bootstrap4、Jquery

## 文件功能说明

```
/static/               #储存静态文件
/template/             #储存模板文件
/app.py                #网站主要功能
/client.py             #与后端通信
/jsontool.py           #在结构化数据和普通字符串之间转换，用于前后端通信、与移动端通信
/__init__.py
```

## 模块功能说明

### URL

​	这是一个网站最基本的功能。在这个网站里面，在/action/下的URL负责处理各种请求，而根目录下的URL是直接面向用户的界面。

* / 首页
* /user/\<userid\> 查询id为userid的用户信息
* /login 旧的登陆界面，已经被废弃
* /query 查询车票界面
* /query_train 查询车次界面
* /query_user 查询用户信息界面
* /query_order 查询购票记录
* /add_train 增加车次
* /modify_train 修改车次
* /signup 惨遭废弃的注册界面
* /manage_train 管理车次界面
* /action/login 处理登陆
* /action/signup 处理注册
* /action/modify_profile 处理修改用户信息
* /action/query_order 处理查询购票记录请求
* /action/logout 处理登出请求
* /action/query_user 处理查询用户信息请求
* /action/query 处理查询车票请求
* /action/buy 处理购票请求
* /action/refund 处理退票请求
* /action/add_train 处理加车请求
* /action/modify_train 处理修改车次请求
* /action/del_train 处理删除车次的请求
* /action/sale_train 处理发售车次的请求
* /action/list_train 处理列出所有未出售车次的请求（用于管理车次界面）
* **/action/post与移动端通信**

### Session

​	session主要用于保存用户登录信息

### 与移动端通信

​	在/action/post下，接受从移动端发来的经过AES加密后的json信息（POST方式），并返回经过AES加密后的json信息。

### 前端的前端

​	主要使用bootstrap，并使用自己写的CSS做了一些小修改。表单验证方面使用了jquery validation，车站名的自动完成使用了jquery autocomplete， 增加车次里面的表格使用了js-grid。AJAX使用的是jquery提供的接口。

# 开发心得

累死老子了。